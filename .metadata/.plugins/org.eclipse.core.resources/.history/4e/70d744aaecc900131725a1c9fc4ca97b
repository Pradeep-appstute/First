/*    */ package com.estimote.sdk.service;
/*    */ 
/*    */ import android.os.Messenger;
/*    */ import com.estimote.sdk.Beacon;
/*    */ import com.estimote.sdk.Region;
/*    */ import com.estimote.sdk.Utils;
/*    */ import com.estimote.sdk.utils.L;
/*    */ import java.util.ArrayList;
/*    */ import java.util.Collection;
/*    */ import java.util.Collections;
/*    */ import java.util.Comparator;
/*    */ import java.util.Iterator;
/*    */ import java.util.Map;
/*    */ import java.util.Map.Entry;
/*    */ import java.util.Set;
/*    */ import java.util.concurrent.ConcurrentHashMap;
/*    */ 
/*    */ class RangingRegion
/*    */ {
/* 26 */   private static final Comparator<Beacon> BEACON_ACCURACY_COMPARATOR = new Comparator()
/*    */   {
/*   
/* 26 */

@Override
public int compare(Beacon lhs, Beacon rhs) {
	  return Double.compare(Utils.computeAccuracy(lhs), Utils.computeAccuracy(rhs));
}   };
/*    */   private final ConcurrentHashMap<Beacon, Long> beacons;
/*    */   final Region region;
/*    */   final Messenger replyTo;
/*    */ 
/*    */   RangingRegion(Region region, Messenger replyTo)
/*    */   {
/* 43 */     this.region = region;
/* 44 */     this.replyTo = replyTo;
/* 45 */     this.beacons = new ConcurrentHashMap();
/*    */   }
/*    */ 
/*    */   public final Collection<Beacon> getSortedBeacons()
/*    */   {
/* 52 */     ArrayList sortedBeacons = new ArrayList(this.beacons.keySet());
/* 53 */     Collections.sort(sortedBeacons, BEACON_ACCURACY_COMPARATOR);
/* 54 */     return sortedBeacons;
/*    */   }
/*    */ 
/*    */   public final void processFoundBeacons(Map<Beacon, Long> beaconsFoundInScanCycle)
/*    */   {
/* 64 */     for (Map.Entry entry : beaconsFoundInScanCycle.entrySet())
/* 65 */       if (Utils.isBeaconInRegion((Beacon)entry.getKey(), this.region))
/*    */       {
/* 68 */         this.beacons.remove(entry.getKey());
/* 69 */         this.beacons.put(entry.getKey(), entry.getValue());
/*    */       }
/*    */   }
/*    */ 
/*    */   public final void removeNotSeenBeacons(long currentTimeMillis)
/*    */   {
/* 80 */     Iterator iterator = this.beacons.entrySet().iterator();
/* 81 */     while (iterator.hasNext()) {
/* 82 */       Map.Entry entry = (Map.Entry)iterator.next();
/* 83 */       if (currentTimeMillis - ((Long)entry.getValue()).longValue() > BeaconService.EXPIRATION_MILLIS) {
/* 84 */         L.v("Not seen lately: " + entry.getKey());
/* 85 */         iterator.remove();
/*    */       }
/*    */     }
/*    */   }
/*    */ }

/* Location:           /Users/AppstuteMac5/Downloads/Android-SDK-master/EstimoteSDK/estimote-sdk-preview.jar
 * Qualified Name:     com.estimote.sdk.service.RangingRegion
 * JD-Core Version:    0.6.2
 */